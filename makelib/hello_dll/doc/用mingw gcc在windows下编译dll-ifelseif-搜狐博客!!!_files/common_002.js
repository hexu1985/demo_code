//20140414
function timeStamp(){var e=new Date;return e.getTime()}function getFullUrl(e){return e.indexOf("http://")==0||e.indexOf("https://")==0?e:e.indexOf("/")==0?location.protocol+"//"+location.host+e:e.indexOf("www")==0?"http://"+e:location.href.substr(0,location.href.lastIndexOf("/")+1)+e}function isLocalFile(e){var t=/^http:\/\/|ftp:\/\/|(https:\/\/)/;return t.test(e)?e.replace(t,"").substr(0,e.replace(t,"").indexOf("/"))==location.host?!0:!1:!0}function getTureLength(e){if(e==null)return null;var t=/^[\x00-\xff]+$/,n=/[^\x00-\xff]+/g,r=0;for(var i=0;i<e.length;i++){var s=e.charAt(i);t.test(s)?r+=1:r+=2}return r}function getUrlParam(e){var t=unescape(location.search);if(!t)return;t=t.substring(1);var n,r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","gi");return n=r.exec(t),n?n[2]:null}function getPref(e){var t,n,r=new RegExp("(^||)"+e+"=([^|]*)(||$)","gi");if(getCookie(prefStr)){n=getCookie(prefStr),t=r.exec(n);if(t)return t[2]}return null}function setPref(e,t){var n,r,i,s=new RegExp("(^||)"+e+"=([^|]*)(||$)","gi");getCookie(prefStr)?(r=getCookie(prefStr),n=s.exec(r),n?i=r.replace(n[0],e+"="+t):i=r+"|"+e+"="+t):i=e+"="+t,setCookie(prefStr,i,"never","/","blog.sohu.com")}function getPrefCur(e){var t,n,r=new RegExp("(^||)"+e+"=([^|]*)(||$)","gi");if(getCookie(prefCurStr)){n=getCookie(prefCurStr),t=r.exec(n);if(t)return t[2]}return null}function setPrefCur(e,t){var n,r,i,s=new RegExp("(^||)"+e+"=([^|]*)(||$)","gi");getCookie(prefCurStr)?(r=getCookie(prefCurStr),n=s.exec(r),n?i=r.replace(n[0],e+"="+t):i=r+"|"+e+"="+t):i=e+"="+t,setCookie(prefCurStr,i,"","/","blog.sohu.com")}function isPPLogin(){var e;return typeof PassportSC!="undefined"&&(e=getPPP())?!0:!1}function isLogin(){if(isPPLogin()){var e;return(e=getP())&&e==getPPP()&&hasBlog()?!0:!1}return!1}function getProduct(e){return e?typeof PassportSC=="undefined"||!PassportSC?!1:((!PassportSC.cookie||!PassportSC.cookie.service)&&PassportSC.parsePassportCookie(),PassportSC.cookie.service[e]!=0?PassportSC.cookie.service[e]:!1):!1}function hasBlog(){(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.I)&&BlogCookieInfo.parseCookie();var e=BlogCookieInfo.cookie.I;return e!=null&&e!=""&&e!="null"?e:!1}function getPPP(){if(typeof PassportSC!="undefined"&&PassportSC&&PassportSC.cookieHandle){var e=PassportSC.cookieHandle();return e.indexOf("@focus.cn")>0&&(e=PassportSC.cookie.uid+"@focus.cn"),e}return""}function getP(){(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.P)&&BlogCookieInfo.parseCookie();var e=BlogCookieInfo.cookie.P,t="";if(e){try{t=b64_decodex(e),t.indexOf("@")<0&&(t="")}catch(n){}return t}return""}function getXP(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ud)&&BlogCookieInfo.parseCookie(),BlogCookieInfo.cookie.P}function getD(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ud)&&BlogCookieInfo.parseCookie(),BlogCookieInfo.cookie.ud}function isMyBlog(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.I)&&BlogCookieInfo.parseCookie(),isLogin()&&hasBlog()&&typeof _ebi!="undefined"&&_ebi&&BlogCookieInfo.cookie.I==_ebi?!0:!1}function getUserType(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.B_TP)&&BlogCookieInfo.parseCookie(),BlogCookieInfo.cookie.B_TP}function getUserName(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.name)&&BlogCookieInfo.parseCookie(),BlogCookieInfo.cookie.name}function getUserIco(){return(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ico)&&BlogCookieInfo.parseCookie(),BlogCookieInfo.cookie.ico}function is17173User(){return getP()&&getP().indexOf("@17173")>0}function getBlogTitle(){return $("blogTitle")?$("blogTitle").lastChild.innerHTML:null}function highLightMsg(e){if(!$(e))return;var t=$(e);t.style.borderColor="#29aba3"}function highLightErr(e){if(!$(e))return;var t=$(e);t.style.borderColor="red"}function lowLightMsg(e){if(!$(e))return;var t=$(e);t.style.borderColor="#ccc"}function flashMsg(e){if(!$(e))return;var t=$(e);setTimeout(function(){highLightMsg(t)},0),setTimeout(function(){lowLightMsg(t)},50),setTimeout(function(){highLightMsg(t)},150),setTimeout(function(){lowLightMsg(t)},200),setTimeout(function(){highLightMsg(t)},300),setTimeout(function(){lowLightMsg(t)},350),setTimeout(function(){highLightMsg(t)},450),setTimeout(function(){lowLightMsg(t)},1500)}function flashErr(e){if(!$(e))return;var t=$(e);setTimeout(function(){highLightErr(t)},0),setTimeout(function(){lowLightMsg(t)},50),setTimeout(function(){highLightErr(t)},150),setTimeout(function(){lowLightMsg(t)},200),setTimeout(function(){highLightErr(t)},300),setTimeout(function(){lowLightMsg(t)},350),setTimeout(function(){highLightErr(t)},450),setTimeout(function(){lowLightMsg(t)},1500)}function checkLogonForm(e){return $F("username").length<=0?(alert("请填写用户名"),$("username").focus(),!1):$F("passwd").length<=0?(alert("请填写密码"),$("passwd").focus(),!1):($("reme")&&$F("reme")>=1?(setCookie("username",$F("username"),"never","/","blog.sohu.com"),setCookie("domain",$F("maildomain"),"never","/","blog.sohu.com"),setCookie("rememberme","true","never","/","sohu.com")):(setCookie("username","","never","/","blog.sohu.com"),setCookie("domain","","never","/","blog.sohu.com"),setCookie("rememberme","false","never","/","sohu.com")),$("loginid").value=$F("username")+$F("maildomain"),setParm(e),e.Submit.disabled="disabled",$("submitInfo").style.visibility="visible",!0)}function setLogonForm(){$("username").value=getCookie("username")||"";for(var e=0;e<$("maildomain").options.length;e++)if($("maildomain").options[e].value==getCookie("domain")){$("maildomain").options[e].selected=!0;break}getCookie("rememberme")=="true"&&($("reme").checked=!0,$("passwd").select(),$("passwd").focus())}function getLogonForm(){var e='<form action="http://passport.sohu.com/login.jsp" method="post" target="_top" name="form_login" id="form_login" onsubmit="return checkLogonForm(this)"><input type="hidden" name="loginid" id="loginid" value="" /><table width="100%" border="0" cellspacing="2" cellpadding="0"><tr><td nowrap="nowrap"><label for="username" class="redfont">用户名</label></td><td><input name="username" type="text" class="text" id="username" value="" /> <select name="maildomain" id="maildomain" class="text"><option value="@sohu.com" selected="selected">@sohu.com</option><option value="@chinaren.com">@chinaren.com</option><option value="@vip.sohu.com">@vip.sohu.com</option><option value="@sms.sohu.com">@sms.sohu.com</option><option value="@sol.sohu.com">@sol.sohu.com</option><option value="@sogou.com">@sogou.com</option><option value="@17173.com">17173用户</option></select></td></tr><tr><td nowrap="nowrap"><label for="passwd" class="redfont">密　码</label></td><td><input name="passwd" type="password" class="text" id="passwd" value="" /></td></tr><tr><td></td><td><input name="Submit" id="Submit" type="submit" class="button-submit" value=" 登  录 " />你是新人吗？<a href="/login/reg.do">立刻申请</a><br /><span class="notice" id="submitInfo" style="visibility: hidden">正在登录，请稍候……</span></td></tr><tr><td colspan="2"><label for="save"><input name="reme" type="checkbox" id="reme" value="1" />记住我的登录状态(在公共计算机上请慎用此功能)</label></td></tr></table></form>';return e}function initHead(){new App.EditableText($("blogTitle"),{defaultValue:"搜狐博客",maxLenght:12,editStyle:"editableText",onChange:response}),new App.EditableText($("blogDesc"),{type:"area",defaultValue:"每个人都有属于自己的一片森林，迷失的人迷失了，相逢的人会再相逢。",maxLenght:100,editStyle:"editableArea",onChange:response})}function insertMngOpr(){if(!isMyBlog())return;if(getUserType()==3)return;if(!$("optionNav"))return;var e=$("optionNav"),t="";if(window.location.href.indexOf("/entry/")!=-1){var n=document.createElement("li");t+='<a href="http://blog.sohu.com/manage/entry.do?m=add&t=shortcut" class="navNewEntry" onmousedown="CA.q(\'blog_nav_newEntry\');" target="_blank">写博文</a>',n.innerHTML=t,e.appendChild(n)}}function gotoBlog(){window.open("http://blog.sohu.com/manage/main.do","blogWin")}function gotoPP(){window.open("http://pp.sohu.com/passport","ppWin")}function gotoMusic(){window.open("http://mbox.sogou.com/mbox.so","musicWin")}function gotoVideo(){window.open("http://v.blog.sohu.com/passport","videoWin")}function getConDataUrl(e){return"http://act.blog.sohu.com/blog-contri/cata/con_"+e+".js"}function isOwnBlog(){var e=Base64.encode(PassportSC.cookieHandle());return typeof _upt!="undefined"&&_upt==e?!0:!1}function commonLogin(e,t){if(!jQuery.ppDialog)return;e=e||"",jQuery.ppDialog({appId:"1001",title:"想要发表您的观点吗，马上登录吧！",onLogin:function(){if(isOwnBlog()){location.reload();return}t&&t(),e&&(location.href.indexOf(e)<0&&(location.href=location.href+e),location.reload())}})}function setCPShow(){var e=jQuery,t=e("#commentForm")[0];isPPLogin()||(t.innerHTML='由于最近广告泛滥，暂只允许登录用户对此文评论。<a href="javascript://">登录</a>'),e("a",t).click(function(){commonLogin("#commentbox")})}function getFilterEmotionText(e){return e=e||"",e=e.replace(/ec\=(\"|)([^\"\s]*)(\"|)/g,"> $2 <"),e=e.replace(/\<[^\<\>]*\>/g,""),e=e.replace(/ +/g," "),e=e.replace(/\n+/g,"\n"),e=e.replace(/^\n*/gm,""),e=e.replace(/^\s*/gm,""),e=e.replace(/\n*$/gm,""),e=e.replace(/\s*$/gm,""),e}function getPPSelect(){if(typeof ppuserid=="undefined"||!ppuserid)return"";var e="";e+='<select name="ppSource" id="ppSource" onchange="setPPSource()">',e+='<option value="http://pp.sohu.com/photolist-list-4-'+ppuserid+'-1.html" selected="selected">全部</option>';for(var t=0;t<photosets.length;t++){var n=photosets[t];if(!n.id)continue;e+='<option value="http://pp.sohu.com/set-view-'+n.id+"-"+ppuserid+'-4-1.html">'+n.name+"</option>"}return e+="</select>",e}function getPPLabel(){if(typeof ppuserid=="undefined"||!ppuserid)return"";var e="";return e+='<a href="http://pp.sohu.com/setlist.jhtml?method=list&userId='+ppuserid+'" target="_blank" class="contentLabel" onfocus="this.blur();">转到图片公园</a>',e}function getPPBigFlash(e){if(typeof ppuserid=="undefined"||!ppuserid){$(e).innerHTML="暂时无法获取数据，请稍后再试";return}if(ppuserid<0){$(e).innerHTML="还未开通相册";return}if(!$(e))return;var t="";t+='<object id="myFlash" width=720 height=550 classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0">',t+='<param name="movie" value="http://js4.pp.sohu.com.cn/ppp/blog/flash/show20060525.swf">',t+='<param name="wmode" value="opaque">',t+='<param name="quality" value="autohigh">',t+='<param id="flashvars" name="flashvars" value="urlA=http://pp.sohu.com/photolist-list-4-'+ppuserid+'-1.html"/>',t+='<embed width="720" height="550" src="http://js4.pp.sohu.com.cn/ppp/blog/flash/show20060525.swf?urlA=http://pp.sohu.com/photolist-list-4-'+ppuserid+'-1.html" quality="autohigh" wmode="opaque" type="application/x-shockwave-flash" plugspace="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" name="myFlash" swLiveConnect="true"></embed>',t+="</object>",$(e).innerHTML=t}function getMusicSelect(e){if(!e||e.responseText=="")return"没有获得音乐盒数据";if(!e.responseXML||!e.responseXML.documentElement)return"分析音乐盒数据失败";var t=e.responseXML,n=t.getElementsByTagName("musiclist"),r="";r+='<select name="musicSource" id="musicSource" onchange="setMusicSource()">';for(var i=0;i<n.length;i++){var s=n[i];if(!s.getAttribute("sogouurl"))continue;r+='<option value="'+s.getAttribute("sogouurl").replace("&amp;","&")+'">'+s.getAttribute("name")+"</option>"}return r+="</select>",r}function getIntervalTime(e){var t=new Date,n=t.getTime()-e,r=Math.floor(n/6e4),i=Math.floor(r/60),s=Math.floor(i/24),o="";return s>=1&&(o+=s,o+="天"),i<48&&i>0&&i%24>0&&(o+=i%24,o+="小时"),i==0&&r%60<=2?"刚刚":(i<24&&r>0&&(o+=r%60,o+="分钟"),o+="前",o)}function getNavIco(e,t){if(!e||e=="")e=58;var n="";return e!=0&&(n+='<img class="pageIcon" src="http://js5.pp.sohu.com.cn/ppp/blog/styles_ppp/images/custom/icons/'+icoLib[e]+'" title="'+t+'" />'),n}var BLOG={};~function(e){function n(e,n,r){return t.post(e,n,r,"json")}function r(n,r){var i="http://stat.i.sohu.com/guest/count/count.do?callback=?",s={type:0,xpt:r||e._upt};t.getJSON(i,s).done(function(e){t(n||"#p-visitcount").html(e.count)})}function i(n,r){var i="http://hs.i.sohu.com/account/fullaccountinfo/?cb=?",r=e._upt,s={xpts:r,from:"blog"};t.getJSON(i,s,function(e){t(n||"#p-username").text(e.data[r].nick)})}function s(t,r){var i="http://"+(e._blog_domain?e._blog_domain+".":"")+"blog.sohu.com/a/home/entry/delete.htm",s={ids:t};n(i,s).done(function(e){e.status==0?r.jquery?r.remove():r():alert("删除失败，请稍后再试")})}var t=e.jQuery;BLOG.fetchVisits=r,BLOG.fetchNick=i,BLOG.deleteEntry=s}(this);var Browser={};Browser.ua=function(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("opera")>=0)return"opera";if(e.indexOf("firefox")>=0)return"ff";if(e.indexOf("gecko")>=0)return"moz";if(e.indexOf("msie")){ieVer=parseFloat(e.substr(e.indexOf("msie")+5));if(ieVer>=6)return"ie6";if(ieVer>=5.5)return"ie55";if(ieVer>=5)return"ie5"}return"other"}();var prefStr="Pref",prefCurStr="PrefCur",BlogCookieInfo={cookie:{},parseCookie:function(){if(!getCookie("bloginfo"))return!1;var e=getCookie("bloginfo").split("|");e[0]&&(this.cookie.P=e[0]),e[1]&&(this.cookie.I=e[1]),e[2]&&(this.cookie.ud=e[2]),e[3]&&(this.cookie.B_TP=e[3]),e[4]&&(this.cookie.name=unescape(e[4])),e[5]&&(this.cookie.ico=e[5])},clear:function(){this.cookie={}}};~function(window){function setFriendGroups(){var e="/a/app/friend/group/getgroups.do";$.getJSON(e,function(e){if(e&&e.code==1){var t="",n=e.data.groups;for(var r=0;r<n.length;r++){var i=n[r];t+='<label class="chkbox"><input type="checkbox" name="groups" value="'+i.groupId+'">'+i.groupName+"</label>"}$("#addFrindGroupsCtner").html(t)}})}function addToFavNew(e){var t=FavWin._instance;if(!!t)return;t=new FavWin,FavWin._instance=t;var n={friendId:e.friendId,fnOk:function(){var e=$("#addFriendForm")[0],n=e.groups,r="",i="http://i.sohu.com/a/app/friend/update/group/mapping.do";for(var s=0;s<n.length;s++)n[s].checked&&(r+=n[s].value+",");var o="?friendId="+this.friendId+"&groupIds="+r,u={friendId:this.friendId,groupIds:r};r.length>1&&(r=r.substring(0,r.length-1)),$.getJSON(i+o+"&callback=?",function(e){e.code==0?(t.hide(),done()):alert(e.msg)})}};t.show(n),setFriendGroups()}function checkBlogPM(e){var t="icon_profile_followed",n=$(e.obj).find("i");if(n.hasClass(t)){alert("您已跟随过了");return}var r="/a/app/friend/friend/add.do?",i="xpt="+window._xpt+"&appid=1001";$.getJSON(r+i,function(r){r&&r.data&&(r.code==1?(e.friendId=r.data.friendId,n[0].className=t,addToFavNew(e)):alert(r.msg))})}function addToFav(e){if(e&&(e.sign=="profileWidget"||e.sign=="entryProfile")){checkBlogPM(e);return}}function done(e,t,n){location.reload()}var $=window.jQuery,FavWin=Class.create({initialize:function(){this.box=new Element("div"),this.box.setStyle({display:"none",position:"absolute",zIndex:"2000"}),this.box.innerHTML='<table class="mwinnew mwin3" id="addFriendWin">                <thead><tr><td class="bx"></td><td class="by"></td><td class="bz"></td></tr></thead>                <tfoot><tr><td class="bx"></td><td class="by"></td><td class="bz"></td></tr></tfoot>                <tbody><tr><td class="bx"></td>                        <td class="by">                            <div class="mwt">                                <div class="ttl"><span>添加关注</span><a href="javascript:void(0);" class="mw_close" title="关闭"><b>关闭</b></a></div>                            </div>                            <div class="mw">                                <div class="mwc">                                    <form action="" method="post" name="addFriendForm" id="addFriendForm">                                    <div class="repost">                                            <div class="mwc2" >                                                <p>选择分组</p>                                                <div class="frmc" id="addFrindGroupsCtner"></div>                                                <form ><div class="mwc21" style="height:30px;">                                                    或 <a style="line-height:30px;color:#017AD7" href="#" onclick="$(\'newGroupCtn\').toggle();return false;">新建分组</a><span id="newGroupCtn" style="display:none"><input type="text" name="gname" class="txt">                                                    <p><a href="#" class="fgyes"><b>确定</b></a><a href="#" onclick="$(\'newGroupCtn\').toggle();return false;" class="fgno"><b>取消</b></a></p></span>                                                </div></form>                                            </div>                                    </div>                                    <div class="post">                                        <p class="btns2"><span class="opt"></span><a class="btn" href="javascript:void(0);"><b>确 定</b></a><a class="btn btn_dis" href="javascript:void(0);"><b>取 消</b></a></p>                                    </div>                                    </form>                                </div>                            </div></td>                        <td class="bz"></td>                    </tr>                </tbody>            </table>',this.closeBtn=this.box.down("a.mw_close"),this.cancelBtnCtner=this.box.down("a.btn_dis"),this.okBtn=this.box.down("a.btn"),this.cancelBtn=this.box.down("a.btn",1),this.titleDiv=this.box.down("span"),this.noticeDiv=this.box.down("div.repost_c"),document.body.appendChild(this.box),this.cancelBtn.observe("click",this.hide.bind(this)),this.closeBtn.observe("click",this.hide.bind(this));var e=this.box.down(".fgyes");Event.observe(e,"click",this.addGroup.bindAsEventListener(this))},show:function(e){e=Object.extend({type:"alert",title:"",notice:"",fnOk:function(){}},e||{}),this.okBtn.observe("click",function(){e.fnOk()}),this.cancelBtnCtner.show();var t=Dom.getCenterPos(this.box);this.box.setStyle({top:t.top+"px",left:t.left+"px"}),this.box.show(),this.okBtn.focus()},hide:function(){this.box.remove(),this.reset(),FavWin._instance=null},reset:function(){this.okBtn.stopObserving("click")},addGroup:function(event){var srcEle=Event.element(event);Event.stop(event);var form=srcEle.up("form"),gname=form.gname.value.trim();if(gname==""){alert("请输入分组名称");return}var pars="gname="+encodeURIComponent(gname),addGroupUrl="/a/app/friend/group/add.do";new Ajax.Request(addGroupUrl,{method:"post",parameters:pars,onComplete:function(response){if(response.status!=200){alert("服务器返回异常，请稍后重试");return}eval("var json="+response.responseText);if(json){if(json.code!=1){alert(json.statusText);return}form.gname.value="";var str='<label class="chkbox"><input type="checkbox" name="groups" checked value="'+json.data.gid+'">'+json.data.gname+"</label>";$("addFrindGroupsCtner").insert(str),$("newGroupCtn").hide()}}.bind(this)})}});setTimeout(function(){function e(){var e={sign:"entryProfile",obj:$("a.i-addfriend")[0]};addToFav(e)}var t=$("#m_1");t.delegate("a.i-addfriend","click",function(){isPPLogin()?e():commonLogin("",e)})},2e3)}(this),flashMsg("message"),flashErr("errormsg");var Starter={funs:[],add:function(e){this.funs||(this.funss=[]),this.funs.push(e)},start:function(){if(!this.funs||this.funs.length<=0)return;$A(this.funs).each(function(e){e()})}},LoadBar={show:function(e,t){clearTimeout(this.timeout),e=e||(typeof App!="undefined"&&App.Lang&&App.Lang.loading?App.Lang.loading:"loading..."),this.build(e),t=="ok"?Element.addClassName(this.element,"okBar"):Element.removeClassName(this.element,"okBar"),Element.show(this.element),this.element.style.right="0px",this.element.style.top=document.documentElement.scrollTop+30+"px",this.showStatusBar(e)},hide:function(e){LoadBar.element&&(LoadBar.timeout=setTimeout(function(){LoadBar.element&&Element.hide(LoadBar.element),LoadBar.hideStatusBar()},e&&!isNaN(e)?e:0))},destroy:function(){this.element&&(Element.remove(this.element),this.element=null)},build:function(e){if(this.element){this.element.firstChild.firstChild.alt=e,this.element.firstChild.childNodes[1].nodeValue=e;return}this.element=document.createElement("div"),Element.addClassName(this.element,"loadBar"),this.element.style.zIndex=1e3,this.element.style.position="absolute",Element.hide(this.element);var t=document.createElement("div"),n=typeof App!="undefined"&&App.Actions&&App.Actions.imgPath?App.Actions.imgPath+"loading.gif":"http://js2.pp.sohu.com.cn/ppp/blog/styles_ppp/images/loading.gif";t.innerHTML='<img src="'+n+'" alt="text" />'+e,this.element.appendChild(t),document.body.appendChild(this.element)},showStatusBar:function(e){setTimeout(function(){window.status=e},10)},hideStatusBar:function(){setTimeout(function(){window.status=""},10)},loadPage:function(){this.show("请稍候，正在下载...")}};Starter.add(LoadBar.hide),$("_preLoadText")&&(Element.hide($("_preLoadText")),LoadBar.loadPage()),Starter.add(insertMngOpr),~function(e){function n(e,n,r){return e.map(function(e,i){var s=t(i),o=r||s.attr("data-entryid");return n[o]=s,o}).toArray().join(",")}function r(r,i,s){var o={},u=typeof r=="string"?t(r):r,a=n(u,o),f=a.split(",")[0],l="http://ana.blog.sohu.com/blogcount?"+(s?"e=":"l=")+(s?f:a);t.getScript(l).done(function(){e.Blog&&e.Blog.ercs_&&(s?u.each(function(){t(this).find(i).html(e.Blog.ercs_[f])}):t.each(e.Blog.ercs_,function(e,t){o[e].find(i).html(t)}))})}function i(e,n){var r={},i=typeof e=="string"?t(e):e,s="http://cc.i.sohu.com/a/app/mblog/getCounts.htm?callback=?",o=i.map(function(e,n){var i=t(n),s=i.attr("data-entryid");return r[s]=i,"blog_"+s}).toArray().join(",");t.getJSON(s,{ids:o}).done(function(e){t.each(e,function(e,t){r[e].find(n).html(t.commentcount)})})}function s(e){var n="http://i.sohu.com/a/app/friend/get/friend/relation.do?cb=?";t.getJSON(n,{xpts:e}).done(function(e){if(e.code==0&&e.data.friendList.length>0){var n=t(".i-addfriend").find("i");n&&n.removeClass().addClass("icon_profile_followed")}})}function u(e,t,n,r,i,s){if(!e)return;i==0&&(i=1);var o=Math.ceil(n/r);o=o||1;var u="";u+="共"+o+"页",u+="&nbsp;&nbsp;|&nbsp;&nbsp;",i==t?(u+="第一页",u+="&nbsp;",u+="上一页"):(u+='<a href="javascript:void 0" onclick="'+s+"("+t+');return false;">第一页</a>',u+="&nbsp;",u+='<a href="javascript:void 0" onclick="'+s+"("+(i-1)+');return false;">上一页</a>'),u+="&nbsp;";for(var a=t;a<=o;a++)if(a==i)u+=a,u+="&nbsp;";else if(a>=i-5&&a<=i+5)u+='<a href="javascript:void 0" onclick="'+s+"("+a+');return false;">['+a+"]</a>",u+="&nbsp;";else if(a==i-6||a==i+6)u+="...&nbsp;";i==o?(u+="下一页",u+="&nbsp;",u+="最末页"):(u+='<a href="javascript:void 0" onclick="'+s+"("+(i+1)+');return false;">下一页</a>',u+="&nbsp;",u+='<a href="javascript:void 0" onclick="'+s+"("+o+');return false;">最末页</a>'),e.innerHTML=u}function a(){setTimeout(LoadBar.hide,500),a.jumpAnchor&&setTimeout(function(){location.hash="#entry"},600),a.jumpAnchor=!0,o.$item=null,o.showItemOpr(),o.fetchReads(),o.fetchComments(),o.getFriend(),o.initEvent()}function f(e,t,n,r){e>0&&LoadBar.show("读取中..."),r=r||"frag";var i="/action/v_"+r+"-ebi_"+escape(_ebi);e>1&&(i+="-pg_"+e),t>0&&(i+="-c_"+t),i+="/entry/";var s="";n&&(s+="tag="+escape(n)),isMyBlog()&&(s+=s?"&o=true":"o=true"),new Ajax.Updater("entryList",i,{method:"get",parameters:s,onComplete:a})}function l(e){return curPage=e||0,f(curPage,category,tag),u(pageTextContainer,startPage,totalCount,itemPerPage,curPage,chagePageAction),!1}function c(e){return curPage=e||0,f(curPage,category,tag,"recmd"),u(pageTextContainer,startPage,totalCount,itemPerPage,curPage,chagePageAction),!1}var t=e.jQuery,o={$item:null,showItemOpr:function(e){isMyBlog()&&(t("span.opr").show(),t("span.share").hide())},fetchComments:function(){this.$item||(this.$item=t("[data-entryid]")),i(this.$item,".itemCmtCount")},fetchReads:function(e){this.$item||(this.$item=t("[data-entryid]")),r(this.$item,".itemReadCount",e)},getFriend:function(){isLogin()&&!isMyBlog()&&s(_xpt)},initEvent:function(){t("[data-act=deleteEntry]").click(function(){var e=confirm("确认要删除吗？");if(e){var n=t(this).closest("[data-entryid]"),r=n.attr("data-entryid");BLOG.deleteEntry(r,n)}})}};e.Entries=o,e.chageEntryPage=l,e.chageRecmdEntryPage=c,e.getPageText=u}(this);var PTags={getTags:function(e,t){if(!e)return;typeof t.max!="number"&&(t.max=-1),e.innerHTML="正在加载...";var n="http://ptag.blog.sohu.com/btags/"+_ebi+"/all/";new LinkFile(n,{type:"script",noCache:isMyBlog(),callBack:{variable:"BlogPtags.tags_abc",onLoad:this.showAbc.bind(this,e,t),onFailure:this.noData.bind(this,e,t)}})},showAbc:function(e,t){if(!BlogPtags.tags_abc||BlogPtags.tags_abc.length<=0){e.innerHTML="暂无标签";return}var n="";n+='<ul class="ptags">';var r=0,i=t.max,s=this.getItemStr;this.getLevels(BlogPtags.tags_abc).each(function(e){if(i!=-1&&r++>=i)throw $break;n+=s(e)}),n+="</ul>",i!=-1&&r>=i&&(n+='<div style="cursor:pointer;float:right;">查看全部标签</div>'),e.innerHTML=n,i!=-1&&r>=20&&Event.observe(e.lastChild,"click",this.showAllAbc.bind(this,e)),t&&t.onOkShow&&t.onOkShow()},showAllAbc:function(e){var t="";t+='<ul class="ptags">';var n=this.getItemStr;this.getLevels(BlogPtags.tags_abc).each(function(e){t+=n(e)}),t+="</ul>",e.innerHTML=t},getItemStr:function(e){var t='<li class="ptag_'+e.level+'">';return t+='<a href="'+_blog_base_url+"tag/"+e.encode+'/" title="'+e.count+'篇">',t+=e.tag,t+="</a>",t+="</li>",t},noData:function(e,t){e.innerHTML="暂时无法获取数据，请稍后再试",t&&t.onErrorShow&&t.onErrorShow()},getLevels:function(e){var t=e.max(function(e){return parseInt(e.count)}),n=e.min(function(e){return parseInt(e.count)}),r=[];return r[0]=Math.floor((t-n)*.9)+n,r[1]=Math.floor((t-n)*.7)+n,r[2]=Math.floor((t-n)*.4)+n,e.map(function(e){return e.level=e.count>r[0]?4:e.count>r[1]?3:e.count>r[2]?2:1,e})}};~function(e){function t(t){var n="http://i.sohu.com/a/app/discuss/indexBlogList.htm?_input_encode=UTF-8",r="blog_"+entryId+"_0_"+e._upt,i=t||1,s=10;n+="&ids="+r,n+="&page="+i,n+="&sz="+s,jQuery.getJSON(n+"&callback=?",function(e){if(!e||!e.discusss||!e.discusss.length)return;var t=$("commentlist");t.innerHTML="",Comments.list(e);var n=1,r=e.discusscount;getPageText(pageTextContainer,n,r,s,i,chagePageAction),setTimeout(Comments.insertCmtOpr.bind(Comments),10)})}function n(e,t,n,i){t>0&&LoadBar.show("读取中..."),t=t||1;var s="",o="/action/m_list-id_"+e+"-cc_"+n+"-pg_"+t+"/comment/";i&&(s="nc=true"),$("commentlist")&&new Ajax.Updater("commentlist",o,{method:"get",parameters:s,onComplete:r})}function r(){setTimeout(LoadBar.hide,500),r.jumpAnchor&&setTimeout(function(){location.hash="#comment"},600),r.jumpAnchor=!0,setTimeout(Comments.insertCmtOpr.bind(Comments),10),setTimeout(Comments.insertIconInfo.bind(Comments),10),setTimeout(Comments.initCandleMen.bind(Comments),10)}function i(e){return curPage=e||0,typeof blogId=="undefined"?n(entryId,curPage,totalCount,noCache):t(curPage),!1}function s(){function u(e){if(e.code==0){i();var t=$("commentContent");t&&(t.value="",t.focus()),alert("评论成功，请到最末页查看")}else alert(e.msg||"评论失败，请稍后再试")}var t=$F("commentContent");if(t.length==0)return alert("评论内容不能为空"),$("commentContent").focus(),!1;if(t.length>300)return alert("评论内容过多，最多为300字"),$("commentContent").focus(),!1;var n="/a/app/discuss/save.htm?_input_encode=UTF-8",r=jQuery("[name=replytopassport]").val(),s=jQuery("[name=replytodiscussid]").val(),o={from:"oldBlog",appid:"blog",discusstype:"0",content:t,itemid:entryId,orixpt:e._xpt};r!==""&&t.substr(0,3)=="回复@"&&(o.replytopassport=r,o.replytodiscussid=s),jQuery.ajax({type:"POST",url:n,data:o,success:u,dataType:"json"})}e.chagePage=i,e.checkCForm=s}(this),~function(e){function u(e){if(!e)return;var t="",n=/@{[^{]*}/g;return t=e.replace(n,function(e){var t=e.replace("@","");try{var n=jQuery.parseJSON(t)}catch(r){return e}return"@"+n.snick}),t}var t=e.jQuery,n,r="http://js3.pp.sohu.com.cn/ppp/images/emotion/base/",i="http://js3.pp.sohu.com.cn/ppp/images/emotion/s/",s="http://js3.pp.sohu.com.cn/ppp/images/emotion/b/",o={base:{"[:)]":["smile.gif","微笑"],"[#_#]":["flatter.gif","谄媚"],"[8*)]":["titter.gif","偷笑"],"[:D]":["spit.gif","大笑"],"[:-)]":["shame.gif","害羞"],"[:P]":["naughty.gif","调皮"],"[B_)]":["complacent.gif","得意"],"[B_I]":["cool.gif","耍酷"],"[^_*]":["lash.gif","讽刺"],"[:$]":["complaint.gif","委屈"],"[:|]":["gloomy.gif","郁闷"],"[:(]":["sorry.gif","难过"],"[:.(]":["weep.gif","泪奔"],"[:_(]":["cry.gif","大哭"],"[):(]":["detonate.gif","发火"],"[:V]":["curse.gif","咒骂"],"[*_*]":["muzzy.gif","发呆"],"[:^]":["misunderstand.gif","不懂"],"[:?]":["haze.gif","疑惑"],"[:!]":["surprise.gif","吃惊"],"[=:|]":["perspire.gif","流汗"],"[:%]":["embarrassed.gif","尴尬"],"[:O]":["fright.gif","惊恐"],"[:X]":["stopper.gif","闭嘴"],"[|-)]":["yawn.gif","犯困"],"[:Z]":["sleep.gif","睡觉"],"[:9]":["greedy.gif","馋"],"[:T]":["puke.gif","吐"],"[:-*]":["whisper.gif","耳语"],"[*_/]":["pirate.gif","海盗"],"[:#|]":["bandage.gif","重伤"],"[:69]":["hug.gif","拥抱"],"[//shuang]":["comfortably.gif","爽"],"[//qiang]":["strong.gif","强"],"[//ku]":["cool2.gif","酷"],"[//zan]":["good.gif","赞"],"[//heart]":["heart.gif","红心"],"[//break]":["hearted.gif","心碎"],"[//F]":["blow.gif","花开"],"[//W]":["fade.gif","花谢"],"[//mail]":["mail.gif","邮件"],"[//strong]":["fine.gif","手势-棒"],"[//weak]":["bad.gif","手势-逊"],"[//share]":["share.gif","握手"],"[//phone]":["phone.gif","电话"],"[//mobile]":["mobile.gif","手机"],"[//kiss]":["lip.gif","嘴唇"],"[//V]":["victory.gif","V"],"[//sun]":["sun.gif","太阳"],"[//moon]":["moon.gif","月亮"],"[//star]":["star.gif","星星"],"[(!)]":["bulb.gif","灯泡"],"[//TV]":["tv.gif","电视"],"[//clock]":["clock.gif","闹钟"],"[//gift]":["gift.gif","礼物"],"[//cash]":["cash.gif","现金"],"[//coffee]":["coffee.gif","咖啡"],"[//rice]":["dining.gif","饭"],"[//watermelon]":["watermelon.gif","西瓜"],"[//tomato]":["tomato.gif","番茄"],"[//pill]":["pill.gif","药丸"],"[//pig]":["pig.gif","猪头"],"[//football]":["football.gif","足球"],"[//shit]":["shit.gif","便便"]},fox:{"[{s}//pig]":["pig.gif","猪头"],"[{s}//heart]":["heart.gif","红心"],"[{s}B_I]":["cool.gif","耍酷"],"[{s}snt]":["snot.gif","鼻涕"],"[{s}=:|]":["perspire.gif","流汗"],"[{s}8*)]":["titter.gif","偷笑"],"[{s}elv]":["elvis.gif","猫王"],"[{s}nob]":["nostbleed.gif","鼻血"],"[{s}:D]":["spit.gif","大笑"],"[{s}lny]":["loney.gif","坏笑"],"[{s}:_(]":["cry.gif","大哭"],"[{s}rdf]":["redflag.gif","红旗"],"[{s}:9]":["greedy.gif","馋"],"[{s}:|]":["gloomy.gif","郁闷"],"[{s}//shit]":["shit.gif","便便"],"[{s}ctm]":["contemn.gif","蔑视"],"[{s}plg]":["plunger.gif","搋子"],"[{s}:Z]":["sleep.gif","睡觉"],"[{s}:#|]":["bandage.gif","重伤"],"[{s}:?]":["haze.gif","疑惑"],"[{s}ft]":["faint.gif","晕"],"[{s}//zan]":["good.gif","赞"],"[{s}epd]":["explode.gif","爆炸"],"[{s}//share]":["share.gif","握手"],"[{s}:$]":["complaint.gif","委屈"],"[{s}drk]":["drink.gif","饮料"],"[{s}brs]":["brushing.gif","刷牙"],"[{s}//rice]":["dining.gif","饭"],"[{s}bra]":["bra.gif","胸罩"],"[{s}spk]":["speaker.gif","喇叭"],"[{s}//clock]":["clock.gif","闹钟"],"[{s}xms]":["xmas.gif","圣诞"],"[{s}bsk]":["basketball.gif","篮球"],"[{s}flw]":["floweret.gif","小花"],"[{s}ber]":["beer.gif","啤酒"],"[{s}cak]":["cake.gif","蛋糕"],"[{s}chr]":["cheer.gif","加油"],"[{s}oly]":["olympic.gif","奥运"],"[{s}tor]":["torch.gif","火炬"],"[{s}up]":["up.gif","顶"]},pafu:{"[{b}hi]":["hi.gif","HI"],"[{b}ok]":["ok.gif","OK"],"[{b}fco]":["faceoff.gif","变脸"],"[{b}:T]":["puke.gif","吐"],"[{b}:D]":["spit.gif","大笑"],"[{b}):(]":["detonate.gif","发火"],"[{b}:!]":["surprise.gif","吃惊"],"[{b}bet]":["beat.gif","扁人"],"[{b}ft]":["faint.gif","晕"],"[{b}gdn]":["goodnight.gif","晚安"],"[{b}#_#]":["flatter.gif","谄媚"],"[{b}=:|]":["perspire.gif","流汗"],"[{b}sof]":["sofa.gif","沙发"],"[{b}:.(]":["weep.gif","泪奔"],"[{b}nob]":["nostbleed.gif","鼻血"],"[{b}glw]":["gallow.gif","我吓死你"],"[{b}thd]":["thunder.gif","被雷到了"],"[{b}pas]":["pass.gif","路过"],"[{b}:?]":["haze.gif","疑惑"],"[{b}mop]":["mop.gif","鬼脸"],"[{b}b4]":["b4.gif","鄙视"],"[{b}^_*]":["lash.gif","讽刺"],"[{b}:(]":["sorry.gif","难过"],"[{b}up]":["up.gif","顶"],"[{b}agi]":["agitation.gif","咱聊聊啊"],"[{b}soy]":["soysauce.gif","打酱油"],"[{b}stg]":["struggle.gif","努力"],"[{b}bj]":["beijing.gif","北京欢迎您"],"[{b}cmp]":["champion.gif","冠军"],"[{b}bdn]":["birdnest.gif","鸟巢"],"[{b}fbi]":["feibi.gif","加油哦"],"[{b}skt]":["skate.gif","滑冰"],"[{b}wuy]":["wuying.gif","无影手"],"[{b}olc]":["olymcheer.gif","奥运加油"]}},a={CMTICO_PREFIX:"icoId_",CMTICOIMG:"http://js1.pp.sohu.com.cn/ppp/blog/images/common/nobody.gif",insertCmtOpr:function(){if(!isMyBlog())return;var e=[];e=document.getElementsByClassName("cmtOpr");if(e.length<1)return;for(var t=0;t<e.length;t++){var n=' |<a href="javascript://" action="delete">';n+='<img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_del.gif" title="删除" align="absbottom">',n+="</a>",e[t].innerHTML||(e[t].innerHTML=n)}},insertIconInfo:function(){if(!isLogin()||!hasBlog())return;var e=[];e=document.getElementsByClassName("cmtIco");if(e.length<=0)return;for(var t=0;t<e.length;t++)if(e[t]&&e[t].id&&e[t].id.indexOf(this.CMTICO_PREFIX)==0){var n=e[t].id.substr(this.CMTICO_PREFIX.length),r=e[t].getElementsByTagName("img")[0];if(n==hasBlog()&&r&&r.src==this.CMTICOIMG){var i="";i+='<a href="http://blog.sohu.com/manage/profile.do" target="_blank" title="上传我的头像">',i+='<img src="'+this.CMTICOIMG+'" />',i+="<span>上传头像</span></a>",e[t].innerHTML=i}}},initCandleMen:function(){SohuIM.setCandleMenParam();try{typeof sohuim!=undefined&&sohuim&&sohuim.candleArmy&&sohuim.candleArmy
.RenderAll&&sohuim.candleArmy.RenderAll(webim_config.cm_container,webim_config.product)}catch(e){}},buildOne:function(e){var t=[],n=this.parseContent(e.content);return t.push('<div class="info-content" cid="'+e.id+'" sname="'+e.sname+'">'),t.push('<div class="cmtIco">'),t.push('<a title="'+e.unick+'" target="_blank" href="'+e.ulink+'">'),t.push('<img src="'+e.uavatar+'"></a></div>'),t.push('<div class="info-title">'),t.push('<h3><a target="_blank" href="'+e.ulink+'">'+e.unick+"</a></h3>"),t.push('<span style="float:right">'+timeUtil.get_timeago(e.createtime)+"</span><br />"),t.push('<div style="margin-top:16px;" class="item-label">'),t.push('<a href="javascript://" action="reply">回复</a><span class="cmtOpr"></span></div></div>'),t.push('<div style="margin-left: 60px; padding-right:40px"><p >'+n+"</p></div>"),t.push('<div class="clear"></div></div>'),t.push("<hr>"),t.join("")},parseContent:function(e){if(typeof e!="string")return;var t=this.parseEmote(e);t=u(t);var n=t.indexOf("@"),r=t.indexOf("：");if(n==-1||r==-1)return t;var i=t.substring(n,r),s=i.substring(1),o='<a target="_blank" href="http://i.sohu.com/nick/'+s+'">'+i+"</a>";return t.replace(RegExp(i),o)},parseEmote:function(e){var t=/(\[[^\[\]]+\])/g,n=e.match(t);if(!n)return e;var u="";for(var a=0,f=n.length;a<f;a++){var l=n[a],c,h,p="";l in o.base?(c=o.base[l],h=r):l in o.fox?(c=o.fox[l],h=i):l in o.pafu&&(c=o.pafu[l],h=s);if(!c)return e;p='<img src="'+h+c[0]+'" title="'+c[1]+'">',u?u=u.replace(l,p):u=e.replace(l,p)}return u},one:function(e){n||(n=t("#commentlist")),str=a.buildOne(e),n.append(str)},list:function(e){e.discusscount&&t(".discusscount").html(e.discusscount);for(var n=0,r=e.discusss.length;n<r;n++)this.one(e.discusss[n])},addEvent:function(){$commentlist=t("#commentlist"),$commentlist.delegate("[action=reply]","click",function(e){var n=t("#commentContent");if(!isLogin()){commonLogin("#commentbox");return}n.length||alert("抱歉，由于博主的设置，您暂时无法评论");var r=t(e.target).closest(".info-content"),i=r.children()[0],s=getFilterEmotionText(i.innerHTML),o=t(e.target).closest(".info-content").find(".info-title").find("h3").find("a"),u=o.first().html(),a=r.attr("sname");n.val("回复@"+a+"："),n[0].focus();try{var f=n[0].createTextRange();f.moveStart("character",n.val().length),f.collapse(!0),f.select()}catch(e){}var l=o.last().attr("param").split(";")[0];t("[name=replytopassport]").val(l),t("[name=replytodiscussid]").val(r.attr("cid"))}),$commentlist.delegate("[action=delete]","click",function(e){var n=t(e.target).closest(".info-content"),r=n.attr("cid"),i="http://i.sohu.com/a/app/discuss/delete.htm?_input_encode=UTF-8";i+="&ids="+r+"_"+_upt,confirm("确认要删除吗？")&&t.getJSON(i+"&callback=?",function(e){e.code==0&&(n.next().remove(),n.remove())})})}};e.Comments=a,e.parseTitle=u}(this),setTimeout(function(){Comments.addEvent()},1500);var timeUtil={serverTime:(new Date).getTime(),timeOffset:0,setServerTime:function(e){e?(this.serverTime=e,this.timeOffset=(new Date).getTime()-e):this.serverTime=(new Date).getTime()-this.timeOffset},get_timeago:function(e){this.setServerTime();var t="",n=1e3,r=n*60,i=r*60,s=this.serverTime,o=new Date(s),u=o.getFullYear(),a=o.getMonth(),f=o.getDate(),l=new Date(u,a,f),c=l.getTime(),h=s-e;if(h<0)t="";else if(h<r*5)t="刚刚";else if(h<i){var p=Math.floor(h/r);t=p+"分钟前"}else if(h<s-c){var d=new Date(e),v=d.getHours(),m=d.getMinutes();v<10&&(v="0"+v),m<10&&(m="0"+m),t="今日 "+v+":"+m}else{var d=new Date(e),g=d.getMonth()+1,y=d.getDate(),v=d.getHours(),m=d.getMinutes();g<10&&(g="0"+g),y<10&&(y="0"+y),v<10&&(v="0"+v),m<10&&(m="0"+m),t=g+"月"+y+"日 "+v+":"+m}return t}},Emotion={iconPath:"http://js3.pp.sohu.com.cn/ppp/images/emotion/",lib:[["[:)]","0.gif","微笑"],["[#_#]","1.gif","谄媚"],["[8*)]","2.gif","偷笑"],["[:D]","3.gif","大笑"],["[:-)]","4.gif","害羞"],["[:P]","5.gif","调皮"],["[B_)]","6.gif","得意"],["[B_I]","7.gif","耍酷"],["[^_*]","8.gif","讽刺"],["[:$]","9.gif","委屈"],["[:|]","10.gif","郁闷"],["[:(]","11.gif","难过"],["[:.(]","12.gif","流泪"],["[:_(]","13.gif","大哭"],["[):(]","14.gif","发火"],["[:V]","15.gif","咒骂"],["[*_*]","16.gif","发呆"],["[:^]","17.gif","不惑"],["[:?]","18.gif","疑惑"],["[:!]","19.gif","吃惊"],["[=:|]","20.gif","流汗"],["[:%]","21.gif","尴尬"],["[:O]","22.gif","惊恐"],["[:X]","23.gif","闭嘴"],["[|-)]","24.gif","犯困"],["[:Z]","25.gif","睡觉"],["[:9]","26.gif","馋"],["[:T]","27.gif","吐"],["[:-*]","28.gif","耳语"],["[*_/]","29.gif","海盗"],["[:#|]","30.gif","重伤"],["[:69]","31.gif","拥抱"],["[//shuang]","32.gif","爽"],["[//qiang]","33.gif","强"],["[//ku]","34.gif","酷"],["[//zan]","35.gif","赞"],["[//heart]","36.gif","红心"],["[//break]","37.gif","心碎"],["[//F]","38.gif","花开"],["[//W]","39.gif","花谢"],["[//mail]","40.gif","邮件"],["[//strong]","41.gif","手势-棒"],["[//weak]","42.gif","手势-逊"],["[//share]","43.gif","握手"],["[//phone]","44.gif","电话"],["[//mobile]","45.gif","手机"],["[//kiss]","46.gif","嘴唇"],["[//V]","47.gif","V"],["[//sun]","48.gif","太阳"],["[//moon]","49.gif","月亮"],["[//star]","50.gif","星星"],["[(!)]","51.gif","灯泡"],["[//TV]","52.gif","电视"],["[//clock]","53.gif","闹钟"],["[//gift]","54.gif","礼物"],["[//cash]","55.gif","现金"],["[//coffee]","56.gif","咖啡"],["[//rice]","57.gif","饭"],["[//watermelon]","58.gif","西瓜"],["[//tomato]","59.gif","番茄"],["[//pill]","60.gif","药丸"],["[//pig]","61.gif","猪头"],["[//football]","62.gif","足球"],["[//shit]","63.gif","便便"]],getEmotion:function(e){for(var t=0;t<this.lib.length;t++){var n=this.lib[t];if(n[0]==e)return n}return null},getEmotionIcons:function(){var e="";for(var t=0;t<this.lib.length;t++){var n=this.lib[t];e+='<img src="'+this.iconPath+n[1]+'" alt="'+n[0]+'" ec="'+n[0]+'" />'}return e},insert2frm:function(e,t){e=" "+e+" ";if(t.createTextRange&&t.caretPos){var n=t.caretPos;n.text=n.text.charAt(n.text.length-1)==" "?e+" ":e,t.focus()}else t.value+=e,t.focus()}},icoLib=["none.gif","anchor.gif","attach.gif","basket.gif","bomb.gif","book.gif","book_addresses.gif","book_open.gif","brick.gif","briefcase.gif","bug.gif","cake.gif","calendar_view_day.gif","calendar_view_month.gif","camera.gif","car.gif","cd.gif","chart_bar.gif","chart_curve.gif","chart_organisation.gif","chart_pie.gif","clock.gif","clock_red.gif","cog.gif","coins.gif","color_swatch.gif","comment.gif","computer.gif","connect.gif","creditcards.gif","door.gif","door_open.gif","drink.gif","drink_empty.gif","email.gif","email_open.gif","email_open_image.gif","emoticon_evilgrin.gif","emoticon_grin.gif","emoticon_happy.gif","emoticon_smile.gif","emoticon_surprised.gif","emoticon_tongue.gif","emoticon_unhappy.gif","emoticon_waii.gif","emoticon_wink.gif","exclamation.gif","eye.gif","feed.gif","flag_blue.gif","flag_green.gif","flag_orange.gif","flag_pink.gif","flag_purple.gif","flag_red.gif","flag_yellow.gif","folder.gif","heart.gif","house.gif","image.gif","information.gif","ipod.gif","keyboard.gif","layout.gif","lightbulb.gif","lightbulb_off.gif","lock.gif","lock_open.gif","lorry.gif","lorry_flatbed.gif","magnifier.gif","money.gif","money_dollar.gif","money_euro.gif","money_pound.gif","money_yen.gif","monitor.gif","mouse.gif","music.gif","new.gif","note.gif","page.gif","page_copy.gif","page_white.gif","page_white_acrobat.gif","page_white_code.gif","page_white_compressed.gif","page_white_excel.gif","page_white_flash.gif","page_white_php.gif","page_white_picture.gif","page_white_powerpoint.gif","page_white_text.gif","page_white_word.gif","page_white_world.gif","palette.gif","paste_plain.gif","pencil.gif","phone.gif","photo.gif","picture.gif","printer.gif","printer_empty.gif","rainbow.gif","rosette.gif","server.gif","shield.gif","sport_8ball.gif","sport_basketball.gif","sport_football.gif","sport_golf.gif","sport_raquet.gif","sport_shuttlecock.gif","sport_soccer.gif","sport_tennis.gif","star.gif","stop.gif","tag_blue.gif","tag_green.gif","tag_orange.gif","tag_pink.gif","tag_purple.gif","tag_red.gif","tag_yellow.gif","telephone.gif","television.gif","thumb_down.gif","thumb_up.gif","trash.gif","tux.gif","user.gif","user_female.gif","user_gray.gif","user_green.gif","user_orange.gif","user_red.gif","user_suit.gif","vcard.gif","weather_clouds.gif","weather_cloudy.gif","weather_lightning.gif","weather_rain.gif","weather_snow.gif","weather_sun.gif","world.gif","zoom.gif","chinaren.gif","olympic.gif"],LinkFile=Class.create();LinkFile.prototype={initialize:function(e,t){this.options=Object.extend({type:"script",charset:"",noCache:!1,callBack:null},t||{}),this.options.callBack=Object.extend({variable:null,onLoad:null,timeout:2e4,timerStep:500},t.callBack||{}),this.timer=0,this.loadTimer=null,this.options.type=="script"?this.getJs(e.trim()):this.getCss(e.trim()),this.options.callBack.variable&&(this.options.callBack.vars=this.options.callBack.variable.split("."))},stop:function(){clearInterval(this.loadTimer),this.loadTimer=null,this.timer=0;return},doCallback:function(){if(this.options.type!="script"||!this.options.callBack||!this.options.callBack.vars||!this.options.callBack.onLoad){this.stop();return}this.timer+=this.options.callBack.timerStep;if($A(this.options.callBack.vars).any(function(v,i){var _v=this.options.callBack.vars.slice(0,i+1).join(".");return eval("typeof "+_v+'== "undefined"')||eval(_v+"==null")}.bind(this))&&this.timer<this.options.callBack.timeout)return;clearInterval(this.loadTimer),$A(this.options.callBack.vars).all(function(v,i){var _v=this.options.callBack.vars.slice(0,i+1).join(".");return eval("typeof "+_v+'!= "undefined"')&&eval(_v+"!=null")}.bind(this))?this.options.callBack.onLoad():this.timer>=this.options.callBack.timeout&&this.options.callBack.onFailure&&this.options.callBack.onFailure(),this.loadTimer=null,this.timer=0},getJs:function(e){var t=document.getElementsByTagName("head")[0],n=Element.getChildElementByTagName(t,"SCRIPT");$A(n).each(function(t){getFullUrl(t.getAttribute("src")||"")==getFullUrl(e)&&Element.remove(t)}),this._link=document.createElement("script"),this.options.noCache&&(e+=(e.match(/\?/)?"&":"?")+"c="+timeStamp()),this._link.type="text/javascript",this.options.charset&&(this._link.charset=this.options.charset),this._link.src=e,this.options.callBack&&(this.loadTimer=setInterval(function(){this.doCallback()}.bind(this),this.options.callBack.timerStep)),t.appendChild(this._link)},getCss:function(e){var t=document.getElementsByTagName("head")[0],n=Element.getChildElementByTagName(t,"LINK");$A(n).each(function(t){getFullUrl(t.getAttribute("href")||"")==getFullUrl(e)&&Element.remove(t)}),this._link=document.createElement("link"),this.options.noCache&&(e+=(e.match(/\?/)?"&":"?")+"c="+timeStamp()),this._link.href=e,this._link.type="text/css",this._link.rel="stylesheet",this.options.charset&&(this._link.charset=this.options.charset),t.appendChild(this._link)}};var Info={messages:{"blog.name":"博客名称","blog.domain":"个性域名","blog.desc":"博客描述","blog.detailDesc":"主人档案","comment.author.name":"称呼","comment.author.site":"网站链接","comment.author.email":"邮箱","comment.content":"评论内容","comment.vcode":"验证码","message.author.name":"称呼","message.author.site":"网站链接","message.author.email":"邮箱","message.content":"评论内容","message.vcode":"验证码","entry.title":"日志标题","entry.content":"日志内容","entry.excerpt":"日志摘要","entry.keywords":"关键字","category.name":"分类名称","category.desc":"分类描述","mobile.code":"手机号","mobile.vcode":"验证码","module.title":"模块标题","module.data":"模块参数","module.type":"模块类型","link.title":"友情连接名称","link.desc":"友情连接描述","link.url":"友情连接地址","errors.required":"{0}不能为空.","errors.minlength":"{0}不能少于 {1} 个字符","errors.maxlength":"{0}不能大于 {1} 个字符","errors.range":"{0}必须在{1}个字符和{2}个字符之间","errors.email":"{0}不是一个有效的邮件地址","errors.invalid":"{0}无效.","errors.comment.authorname":" 用户名不能为空.","errors.comment.commentcontent":"评论内容不能为空.","errors.comment.maxcommentlength":"评论内容过多，最多为1000字.","errors.comment.maxauthorName":"称呼过长","errors.comment.maxauthorSite":"网站链接过长","errors.comment.maxcommentContent":"评论内容过长","errors.comment.publish.forbidden":"作者不允许对此文进行评论","errors.comment.publish.needlogin":'作者只允许登录用户才可对此文评论。<a href="http://blog.sohu.com/login/logon.do">登录</a>',"errors.message.authorname":" 用户名不能为空.","errors.message.commentcontent":"留言内容不能为空.","errors.message.maxcommentlength":"留言内容过多，最多为1000字.","errors.message.maxauthorName":"称呼过长","errors.message.maxauthorSite":"网站链接过长","errors.message.maxcommentContent":"留言内容过长","errors.message.publish.forbidden":"作者不允许对留言","errors.message.publish.needlogin":'作者只允许登录用户才可留言。<a href="http://blog.sohu.com/login/logon.do">登录</a>',"errors.message.vcode":" 验证码不能为空.","errors.entry.entrytitle":"请填写日志标题.","errors.entry.maxentrytitle":"日志标题过长.","errors.entry.entrycontent":"请填写日志内容.","errors.entry.maxentryexcerpt":"摘要长度过长","errors.entry.maxentrykeywords":"关键字过长","errors.link.unexist":"该好友不存在","errors.link.reach.limit":"您的好友数量已经达到系统上限","errors.module.reach.limit":"您的模块已经达到系统上限","errors.module.attempt.delete.entry":"不能删除日志模块","errors.general":"操作失败","errors.operate.failure":"数据操作失败","errors.rpc":"操作失败，该页暂时不可用","errors.npe":"系统内部错误","errors.forbidden":"操作失败，请检查是否有相应的权限","errors.param":"参数错误","errors.vcode":"验证码错误，请检查您的输入是否与图片中显示的字母一致","errors.domain.format":"个性域名必须是英文和数字","errors.domain.exist":"个性域名已被占用","errors.number.formate":"参数格式错误","errors.blog.unexis":"博客不存在","errors.blog.onlyfriend":"只有好友可见","errors.login.user.unexist":"用户不存在","errors.login.auth":'认证错误。<ul style="margin:0px;padding:0px;"><li>请检查用户名和密码是否正确。</li><li>请检查您的域名是否正确。提示：如果是17173用户，请注意选择“17173用户”项。',"errors.passport.invalid":"非法的用户名","errors.login":"系统内部错误，请稍后重试","errors.activation":'激活失败，请<a href="/login/activation.do">重试</a>',"errors.auto.activation":'自动激活失败，请<a href="/passport">重试</a>',"errors.blog.unexist":"博客不存在","errors.you.have.not.blog":'您还没有自己的博客,<a href="/login/reg.do">现在就去申请</a>',"errors.entry.unexist":"该日志不存在","errors.entry.private":"该日志已被隐藏","errors.archive.unexist":"该归档不存在","errors.category.unexist":"该分类不存在","errors.mobile.invalidvcode":"您输入的验证码不正确！","errors.mobile.mobilecode":"手机号不能为空","errors.mobile.binding":"该手机号{0}已被绑定","errors.keyword.rewrite":"您发表的内容包含敏感关键字！请重新填写。","errors.entry.contribute.duplicate":"对不起,您已经投过稿了,换一篇试试吧","errors.not.ppp":'您还没有升级到玩弄版,无法进行下一步操作, 现在就<a href="http://blog.sohu.com/manage/upgrade.do">升级</a>?',"messages.general":"操作成功","messages.setting.saved":"修改成功","messages.theme.saved":'主题修改成功，您可以<a href="{0}" target="_blank">点击这里</a>查看修改后的结果',"messages.flash.saved":'Flash特效修改成功，您可以<a href="{0}" target="_blank">点击这里</a>查看修改后的结果',"messages.layout.saved":'页面布局修改成功，您可以<a href="{0}" target="_blank">点击这里</a>查看修改后的结果',"messages.entry.saved":'<div class="noticeInfo"><h3>日志保存成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/entry.do?m=edit&id={0}">继续编辑</a></li><li><a href="/home/entry/list.htm?t=draft">转到草稿列表页面</a></li><li><a href="/manage/entry.do?m=add">撰写另一篇新日志</a></li></ul></div>',"messages.entry.published":'<div class="noticeInfo"><h3>日志发布成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/entry.do">转到日志列表页面</a></li><li><a href="{0}">查看您刚发表的日志</a></li><li><a href="/manage/entry.do?m=add">撰写另一篇新日志</a></li></ul></div>',"messages.entry.shortcutpublished":'<div class="noticeInfo"><h3>日志发布成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="javascript:closeWin();">关闭本页</a></li><li><a href="{1}">查看我的博客首页</a></li><li><a href="{0}">查看您刚发表的日志</a></li><li><a href="/manage/entry.do?m=add&t=shortcut">撰写另一篇新日志</a></li></ul></div>',"messages.entry.shortcutsaved":'<div class="noticeInfo"><h3>日志保存成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/entry.do?m=edit&id={0}&t=shortcut">继续编辑</a></li><li><a href="/home/entry/list.htm?t=draft">转到草稿列表页面</a></li><li><a href="/manage/entry.do?m=add&t=shortcut">撰写另一篇新日志</a></li></ul></div>',"messages.entry.updated":'<div class="noticeInfo"><h3>日志修改成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="{0}">查看您刚修改的日志</a></li><li><a href="/manage/entry.do">转到日志列表页面</a></li></ul></div>',"messages.entry.shortcutupdated":'<div class="noticeInfo"><h3>日志修改成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="javascript:closeWin();">关闭本页</a></li><li><a href="{0}">查看您刚修改的日志</a></li><li><a href="{1}">查看我的博客</a></li></ul></div>',"messages.blog.upgraded":'<div class="noticeInfo"><h3>恭喜您，升级成功！</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="{0}">查看我的博客</a></li><li><a href="javascript:closeWin();">关闭本页</a></li></ul></div>',"messages.blog.down":'<div class="noticeInfo"><h3>降级成功，感谢您的试用</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="{0}">查看我的博客</a></li><li><a href="javascript:closeWin();">关闭本页</a></li></ul></div>',"messages.entry.private":"该日志已被隐藏,只有您自己才能看到","messages.entry.deleted":"日志删除成功","messages.comment.published":'评论发表成功&nbsp;&nbsp;&nbsp;<a href=" http://blog.sohu.com/manage/main.do " target=”_blank” style="color: #069;" onmousedown="CA.a(\'entry_commemt_success\');">查看其他好友的最新日志</a>',"messages.comment.deleted":"评论删除成功","messages.message.published":"留言发表成功","messages.message.deleted":"留言删除成功","messages.category.saved":'<div class="noticeInfo"><h3>分类"{0}"保存成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/category.do">返回列表</a></li><li><a href="manage/category.do?m=add">创建新分类</a></li></ul></div>',"messages.category.updated":'<div class="noticeInfo"><h3>分类"{0}"更新成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/category.do">返回列表</a></li><li><a href="manage/category.do?m=add">创建新分类</a></li></ul></div>',"messages.category.deleted":'分类"{0}"删除成功',"messages.category.added":'<div class="noticeInfo"><h3>分类"{0}"添加成功</h3><div id="autoDir"></div></div><div class="moreInfo"><p>或者您可以：</p><ul><li id="defautAction"><a href="/manage/category.do">返回列表</a></li><li><a href="manage/category.do?m=add">创建新分类</a></li></ul></div>',"messages.profile.saved":"档案修改成功","messages.entry.contributed":"投稿成功。\n如果该日志被录用，将会被展示在相应频道栏目中。同时管理员会以留言方式通知您。","messages.mobile.setsuccess":'设置成功！您可以通过彩信发表博客日记了<br /><a href="/manage/mobile.do">返回</a>',"messages.mobile.cancelsuccess":'您的手机博客服务已经取消!<br /><a href="/manage/mobile.do">返回</a>'},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)","gi");return(t=n.exec(unescape(document.cookie)))?t[2]:null},setCookie:function(e,t,n,r,i){var s=e+"="+escape(t);if(n){n=="never"&&(n=5256e4);var o=new Date;o.setTime(o.getTime()+n*60*1e3),s+="; expires="+o.toGMTString()}r&&(s+="; path="+r),i&&(s+="; domain="+i),document.cookie=s},getInfo:function(e){var t=Info.messages[e];return t?t:e},formatMsg:function(e,t){var n=Info.getInfo(e);if(n&&t)for(var r=0;r<t.length;++r)n=n.replace("{"+r+"}",Info.getInfo(t[r]));return n},formatMsgs:function(e,t,n){var r="";for(var i in e){if(t==0){if(i.indexOf("messages")!=0)continue}else if(t==1&&i.indexOf("errors")!=0)continue;var s=e[i];if(s.constructor==Array){var o=Info.formatMsg(i,e[i]);o&&(r+=o,typeof n=="undefined"||n==""?r+="<br>":r+=n)}}return r},readInfo:function(e,t){var n=Info.getCookie("msg");if(n==""||n=="none")return"";var r=Info.htmlInfo(n,e,t);return r&&r.length>0&&Info.setCookie("msg","none","","/","blog.sohu.com"),r},htmlInfo:function(e,t,n){var r=JSON.parse(e);return r?Info.formatMsgs(r,t,n):e},displayMsg:function(){document.write(Info.readInfo(0))},displayErr:function(){document.write(Info.readInfo(1))}}
var WinMenus={wMenus:[],register:function(wMenu){this.wMenus.push(wMenu)},unregister:function(wMenu){this.wMenus=this.wMenus.reject(function(m){return m==wMenu})}};var WinMenu=Class.create();WinMenu.prototype={initialize:function(options){this.options=Object.extend({menuData:[],elm_extendTop:null,elm_extendBottom:null,title:null,clsBtn:true,shadow:true,shadowOffset:4,dragable:false,placeIn:document.body,click2cls:true,autoCls:false,autoActive:true,btn:null,displace:[],ableExpandSubmenu:true,noneInfo:(typeof App!="undefined")?App.Lang.none:"",zIndex:500,allInOne:false,menuType:"expand",onShow:null,onHide:null,sDivCss:"menuSub-div",imtDivCss:"subMenu-maintitle",imcDivCss:"subMenu-content",itDivCss:"subMenu-title",isDivCss:"menuInnerSub-div",sOutCss:"menuSub-out",sOverCss:"menuSub-over",sDownCss:"menuSub-down",sDisableCss:"menuSub-disabled",sActiveCss:"menuSub-active",Lang:{close:(typeof App!="undefined")?App.Lang.close:"close",loading:(typeof App!="undefined")?App.Lang.loading:"loading"}},options||{});this.buildWin();WinMenus.register(this);this.eventCancelBubble=Event.stop.bindAsEventListener(this);if(this.options.autoCls){Event.observe(this.options.btn,"click",this.eventCancelBubble)}},destroy:function(){Element.remove(this.element);WinMenus.unregister(this)},buildWin:function(){var divSubMenu=document.createElement("div");this.elm_subMenu=divSubMenu;var arr1=[];var arr2=[];this.options.menuData.each(function(sm){var _class=this.options.itDivCss;var _style="";if(sm.itDivExtCss){_class+=" "+sm.itDivExtCss}if(this.options.ableExpandSubmenu){_class+=" ";if(sm.active){_class+=this.options.itDivCss+"-active"}else{_class+=this.options.itDivCss+"-out";_style+=' style="display:none;"'}}arr1.push('<div class="'+_class+' clearfix"'+(sm.title?"":' style="display:none"')+">");arr1.push(sm.title);arr1.push("</div>");arr2.push('<div class="'+this.options.isDivCss+' clearfix"'+_style+">");arr2.push(this.options.Lang.loading);arr2.push("</div>");if(sm.more){arr2.push(sm.more)}if(this.options.menuType=="expand"){arr1=arr1.concat(arr2);arr2=[]}}.bind(this));divSubMenu.innerHTML=arr1.join("")+arr2.join("");this.elm_subTitles=document.getElementsByClassName(this.options.itDivCss,divSubMenu,"div");this.elm_subConts=document.getElementsByClassName(this.options.isDivCss,divSubMenu,"div");if(this.options.ableExpandSubmenu){$A(this.elm_subTitles).each(function(st,i){var btn=st;Event.observe(btn,"click",function(){if(this.options.menuType=="tab"){this.hideSbuContentOther(i)}if(this.elm_subConts[i].style.display=="none"){Element.show(this.elm_subConts[i]);Element.removeClassName(btn,this.options.itDivCss+"-out");Element.addClassName(btn,this.options.itDivCss+"-active");if(this.elm_subConts[i].innerHTML==this.options.Lang.loading){setTimeout(this.buildSubContent.bind(this,i),10)}}else{if(this.options.menuType!="tab"){Element.hide(this.elm_subConts[i]);Element.removeClassName(btn,this.options.itDivCss+"-active");Element.addClassName(btn,this.options.itDivCss+"-out")}}}.bind(this));Event.observe(btn,"mouseover",function(){Element.addClassName(btn,this.options.itDivCss+"-over")}.bind(this));Event.observe(btn,"mouseout",function(){Element.removeClassName(btn,this.options.itDivCss+"-over")}.bind(this))}.bind(this))}var opt4win=Object.extend({},this.options);Object.extend(opt4win,{content:[this.options.elm_extendTop,divSubMenu,this.options.elm_extendBottom],position:function(){var pos=Position.cumulativeOffset(this.options.btn);pos=[pos[0]+(this.options.displace[0]||0),(pos[1]+(this.options.displace[1]||0)+parseInt(this.options.btn.offsetHeight)+2)];return pos}.bind(this)});this.win=new Win(opt4win);setTimeout(this.buildSubContent.bind(this,0),10)},updateMenuData:function(menuData){this.options.menuData=menuData;this.updateSubContent(0)},buildSubContent:function(index){if(isNaN(index)){return}if(!this.options.menuData[index]||!this.elm_subConts[index]){return}if(this.elm_subConts[index].style.display!="none"&&this.elm_subConts[index].innerHTML==this.options.Lang.loading){this.doBuildSubContent(index)}if(index<this.options.menuData.length-1){setTimeout(this.buildSubContent.bind(this,index+1),10)}},updateSubContent:function(index){if(isNaN(index)){return}if(!this.options.menuData[index]||!this.elm_subConts[index]){return}if(this.elm_subConts[index].innerHTML!=this.options.Lang.loading){this.doBuildSubContent(index)}if(index<this.options.menuData.length-1){setTimeout(this.updateSubContent.bind(this,index+1),10)}},doBuildSubContent:function(index){if(this.options.menuData[index].data.constructor==Array){var divSubContent=this.getSubContent(index)}else{if(this.options.menuData[index].data.constructor==Function){var divSubContent=this.options.menuData[index].data(index)}}if(this.elm_subConts[index].style.display=="none"){Element.hide(divSubContent)}if(divSubContent.innerHTML==""){divSubContent.innerHTML=this.options.noneInfo}this.elm_subConts[index].parentNode.insertBefore(divSubContent,this.elm_subConts[index]);Element.remove(this.elm_subConts[index]);
this.elm_subConts[index]=divSubContent},getSubContent:function(index){sm=this.options.menuData[index];var divSubContent=document.createElement("div");divSubContent.className=this.options.isDivCss+" clearfix";if(sm.isDivCssEx){Element.addClassName(divSubContent,sm.isDivCssEx)}sm.data.each(function(si,i){var si={text:si.text||"",title:si.title||"",action:si.action||Prototype.emptyFunction,value:(si.value||!isNaN(si.value))?si.value:null,active:si.active||false,disabled:si.disabled||false};var divSI=document.createElement("div");divSI.className=this.options.sOutCss;if(si.active){Element.addClassName(divSI,this.options.sActiveCss)}if(si.disabled){Element.addClassName(divSI,this.options.sDisableCss)}divSI.innerHTML=si.text;if(si.text){divSI.title=(si.title||si.text)}Event.observe(divSI,"mouseover",function(){if(si.disabled){return}Element.addClassName(divSI,this.options.sOverCss)}.bind(this));Event.observe(divSI,"mouseout",function(){if(si.disabled){return}Element.removeClassName(divSI,this.options.sOverCss);Element.removeClassName(divSI,this.options.sDownCss)}.bind(this));Event.observe(divSI,"mousedown",function(){if(si.disabled){return}Element.addClassName(divSI,this.options.sDownCss)}.bind(this));Event.observe(divSI,"mouseup",function(){if(si.disabled){return}Element.removeClassName(divSI,this.options.sDownCss)}.bind(this));Event.observe(divSI,"click",function(){if(si.disabled){return}if(this.options.autoActive){this.activeItem(index,i)}(si.action)(si.value);if(this.options.click2cls){this.hide()}}.bind(this));divSubContent.appendChild(divSI)}.bind(this));return divSubContent},show:function(){this.win.show()},hide:function(){this.win.hide()},showSubContentOther:function(j){$A(this.elm_subTitles).each(function(st,i){if(this.elm_subConts[i].style.display!="none"||i==j){throw $continue}Element.removeClassName(st,this.options.itDivCss+"-out");Element.addClassName(st,this.options.itDivCss+"-active")}.bind(this));$A(this.elm_subConts).each(function(sc,i){if(sc.style.display!="none"||i==j){throw $continue}Element.show(sc);if(sc.innerHTML==this.options.Lang.loading){setTimeout(this.buildSubContent.bind(this,i),10)}}.bind(this))},hideSbuContentOther:function(j){$A(this.elm_subTitles).each(function(st,i){if(this.elm_subConts[i].style.display=="none"||i==j){throw $continue}Element.removeClassName(st,this.options.itDivCss+"-active");Element.addClassName(st,this.options.itDivCss+"-out")}.bind(this));$A(this.elm_subConts).each(function(sc,i){if(sc.style.display=="none"||i==j){throw $continue}Element.hide(sc)}.bind(this))},activeItem:function(subContIndex,index){$A(this.elm_subConts).each(function(sc,i){if(!this.options.allInOne&&i!=subContIndex){throw $continue}if(sc.innerHTML==this.options.Lang.loading){throw $continue}$A(document.getElementsByClassName(this.options.sOutCss,sc,"div")).each(function(btn,j){if(!btn){throw $break}Element.removeClassName(btn,this.options.sActiveCss);if(subContIndex==i&&index==j){Element.addClassName(btn,this.options.sActiveCss)}}.bind(this))}.bind(this))}};if(typeof Wins=="undefined"||!Wins){var Wins={wins:[],register:function(win){this.wins.push(win)},unregister:function(win){this.wins=this.wins.reject(function(w){return w==win})}};var Win=Class.create();Win.prototype={initialize:function(options){this.options=Object.extend({content:null,title:null,clsBtn:true,shadow:true,shadowOffset:4,dragable:false,placeIn:document.body,autoCls:false,position:[],zIndex:500,okBtn:false,cancelBtn:false,onShow:null,onHide:null,onOk:null,onCancel:null,sDivCss:"menuSub-div",imtDivCss:"subMenu-maintitle",imcDivCss:"subMenu-content",imbDivCss:"subMenu-btnfield",Lang:{close:(typeof App!="undefined")?App.Lang.close:"close",loading:(typeof App!="undefined")?App.Lang.loading:"loading"}},options||{});this.build();Wins.register(this);this.eventCancelBubble=Event.stop.bindAsEventListener(this);if(this.options.autoCls){Event.observe(document,"click",function(e){if(Event.element(e)!=this.element&&!Element.childOf(Event.element(e),this.element)){this.hide()}}.bindAsEventListener(this))}},destroy:function(){Element.remove(this.element);Wins.unregister(this)},build:function(){var divWin=document.createElement("div");this.element=divWin;Element.hide(divWin);var arr=[];arr.push('<div class="'+this.options.sDivCss+'">');if(this.options.title||this.options.clsBtn){arr.push('<div class="'+this.options.imtDivCss+' clearfix">');if(this.options.clsBtn){arr.push('<div class="cls" title="'+this.options.Lang.close+'"></div>')}if(this.options.title){arr.push(this.options.title)}arr.push("</div>")}arr.push('<div class="'+this.options.imcDivCss+'">');arr.push("</div>");if(this.options.okBtn||this.options.cancelBtn){arr.push('<div class="'+this.options.imbDivCss+' clearfix">');if(this.options.okBtn){arr.push('<input type="submit" class="button-submit" value="'+App.Lang.ok+'" />')}if(this.options.cancelBtn){arr.push('<input type="button" class="button" value="'+App.Lang.cancel+'" />')}arr.push("</div>")}arr.push("</div>");this.element.innerHTML=arr.join("");
this.elm_win=this.element.firstChild;if(this.options.title){this.elm_tit=this.elm_win.childNodes[0];this.elm_con=this.elm_win.childNodes[1]}else{this.elm_con=this.elm_win.childNodes[0]}if(this.options.clsBtn){this.elm_cls=this.elm_win.childNodes[0].firstChild;Event.observe(this.elm_cls,"click",function(){if(this.options.onCancel){(this.options.onCancel)()}this.hide()}.bind(this))}if(this.options.okBtn||this.options.cancelBtn){var divBtn=this.elm_win.childNodes[this.elm_win.childNodes.length-1];if(this.options.okBtn){this.elm_ok=divBtn.firstChild;this.elm_cancel=divBtn.childNodes[1]}else{if(this.options.cancelBtn){this.elm_cancel=divBtn.firstChild}}}if(this.elm_ok&&this.options.onOk){Event.observe(this.elm_ok,"click",function(){(this.options.onOk)();this.hide()}.bind(this))}if(this.elm_cancel&&this.options.onCancel){Event.observe(this.elm_cancel,"click",function(){(this.options.onCancel)();this.hide()}.bind(this))}if(this.options.dragable){var opt4drag={starteffect:function(element){},reverteffect:function(element,top_offset,left_offset){},endeffect:function(element){}};if(this.options.title||this.options.clsBtn){opt4drag.handle=this.options.imtDivCss}this.dragObj=new Draggable(this.element,opt4drag)}$(this.options.placeIn).appendChild(divWin);if(this.options.content){if(this.options.content.constructor!=Array){this.elm_con.appendChild(this.options.content)}else{this.options.content.each(function(con){if(con){this.elm_con.appendChild(con)}}.bind(this))}}},show:function(){if(this.showing){return}if(!this.element){this.build()}this.element.style.position="absolute";if(this.options.position&&typeof this.options.position=="function"){var pos=(this.options.position)()}else{var pos=this.options.position}this.element.style.width="10px";this.element.style.height="10px";this.element.style.left=pos[0]+"px";this.element.style.top=pos[1]+"px";this.element.style.zIndex=this.options.zIndex;this.elm_win.style.position="absolute";this.elm_win.style.left="0px";this.elm_win.style.top="0px";this.elm_win.style.zIndex=this.options.zIndex+10;if(Browser.ua.indexOf("ie")<0&&typeof Effect!="undefined"&&Effect){Effect.Appear(this.element,{from:0,to:0.95,duration:0.3,queue:{scope:"optMenu",position:"end"}});setTimeout(this.showFrm.bind(this),400);if(this.options.shadow){this.showShadow_2()}}else{Element.show(this.element);this.showFrm();if(this.options.shadow){this.showShadow()}}this.showing=true;if(this.options.onShow){(this.options.onShow)()}},hide:function(){if(!this.showing){return}if(!this.element){return}if(Browser.ua.indexOf("ie")<0&&typeof Effect!="undefined"&&Effect){Effect.Fade(this.element,{duration:0.3,queue:{scope:"optMenu",position:"end"}});if(this.options.shadow){this.hideShadow_2()}}else{Element.hide(this.element);if(this.options.shadow){this.hideShadow()}}this.hideFrm();this.showing=false;if(this.options.onHide){(this.options.onHide)()}},buildFrm:function(){var frm=document.createElement("iframe");this.elm_frm=frm;frm.style.position="absolute";frm.frameborder="0";frm.style.border="none";Element.hide(frm);this.element.appendChild(frm)},showFrm:function(){if(Browser.ua=="ie5"||Browser.ua=="other"||Browser.ua=="ff"){return}if(!this.elm_frm){this.buildFrm()}if(parseInt(this.elm_frm.offsetHeight)!=parseInt(this.elm_win.offsetHeight)||parseInt(this.elm_frm.offsetWidth)!=parseInt(this.elm_win.offsetWidth)){this.elm_frm.style.zIndex=this.options.zIndex-10;this.elm_frm.style.width=this.elm_win.offsetWidth+"px";this.elm_frm.style.height=this.elm_win.offsetHeight+"px";Element.show(this.elm_frm)}clearTimeout(this.frmTimeout);this.frmTimeout=null;this.frmTimeout=setTimeout(this.showFrm.bind(this),100)},hideFrm:function(){if(!this.elm_frm){return}clearTimeout(this.frmTimeout);this.frmTimeout=null;this.elm_frm.style.height="0px";Element.hide(this.elm_frm)},buildShadow:function(){var divShadow=document.createElement("div");this.elm_shadow=divShadow;divShadow.style.position="absolute";divShadow.style.background="#333";if(Element.setOpacity){Element.setOpacity(divShadow,0.5)}Element.hide(divShadow);this.element.appendChild(divShadow)},showShadow:function(){if(!this.elm_shadow){this.buildShadow()}if(this.elm_shadow.offsetHeight!=this.elm_win.offsetHeight||this.elm_shadow.offsetWidth!=this.elm_win.offsetWidth){this.elm_shadow.style.left=parseInt(this.elm_win.style.left)+this.options.shadowOffset+"px";this.elm_shadow.style.top=parseInt(this.elm_win.style.top)+this.options.shadowOffset+"px";this.elm_shadow.style.zIndex=this.options.zIndex-1;this.elm_shadow.style.width=this.elm_win.offsetWidth+"px";this.elm_shadow.style.height=this.elm_win.offsetHeight+"px";Element.show(this.elm_shadow)}clearTimeout(this.shadowTimeout);this.shadowTimeout=null;this.shadowTimeout=setTimeout(this.showShadow.bind(this),100)},hideShadow:function(){if(!this.elm_shadow){return}clearTimeout(this.shadowTimeout);this.shadowTimeout=null;this.elm_shadow.style.height="0px";Element.hide(this.elm_shadow)},buildShadow_2:function(){var divShadow_r=document.createElement("div");
var divShadow_b=document.createElement("div");this.elm_shadow_r=divShadow_r;this.elm_shadow_b=divShadow_b;divShadow_r.style.position="absolute";divShadow_b.style.position="absolute";divShadow_r.style.background="#333";divShadow_b.style.background="#333";if(Element.setOpacity){Element.setOpacity(divShadow_r,0.5);Element.setOpacity(divShadow_b,0.5)}Element.hide(divShadow_r);Element.hide(divShadow_b);this.element.appendChild(divShadow_r);this.element.appendChild(divShadow_b)},showShadow_2:function(){if(!this.elm_shadow_r||!this.elm_shadow_b){this.buildShadow_2()}if(parseInt(this.elm_shadow_r.offsetHeight)!=parseInt(this.elm_win.offsetHeight)||parseInt(this.elm_shadow_b.offsetWidth)!=parseInt(this.elm_win.offsetWidth)-this.options.shadowOffset){this.elm_shadow_r.style.left=parseInt(this.elm_win.style.left)+parseInt(this.elm_win.offsetWidth)+"px";this.elm_shadow_r.style.top=parseInt(this.elm_win.style.top)+this.options.shadowOffset+"px";this.elm_shadow_b.style.left=parseInt(this.elm_win.style.left)+this.options.shadowOffset+"px";this.elm_shadow_b.style.top=parseInt(this.elm_win.style.top)+parseInt(this.elm_win.offsetHeight)+"px";this.elm_shadow_r.style.zIndex=this.options.zIndex-1;this.elm_shadow_b.style.zIndex=this.options.zIndex-1;this.elm_shadow_r.style.width=this.options.shadowOffset+"px";this.elm_shadow_r.style.height=this.elm_win.offsetHeight+"px";this.elm_shadow_b.style.width=this.elm_win.offsetWidth-this.options.shadowOffset+"px";this.elm_shadow_b.style.height=this.options.shadowOffset+"px";Element.show(this.elm_shadow_r);Element.show(this.elm_shadow_b)}clearTimeout(this.shadowTimeout);this.shadowTimeout=null;this.shadowTimeout=setTimeout(this.showShadow_2.bind(this),100)},hideShadow_2:function(){if(!this.elm_shadow_r||!this.elm_shadow_b){return}clearTimeout(this.shadowTimeout);this.shadowTimeout=null;this.elm_shadow_r.style.height="0px";this.elm_shadow_b.style.width="0px";Effect.Fade(this.elm_shadow_r,{duration:0.3,queue:{scope:"optMenuShadow_r",position:"end"}});Effect.Fade(this.elm_shadow_b,{duration:0.3,queue:{scope:"optMenuShadow_b",position:"end"}})}}}var CA={init:function(){var img=document.createElement("img");img.id="caImg";img.style.display="none";if(document.body){document.body.appendChild(img)}},q:function(from){if(!$("caImg")){return}var arr=[];arr.push("t="+(new Date()).getTime());if(document.referrer){arr.push("r="+encodeURIComponent(document.referrer))}if(ToolBar.isPPLogin()){arr.push("xpt="+encodeURIComponent(ToolBar.getXP()))}if(from){arr.push("from="+from)}var url="http://bgt.blog.sohu.com/blogclick.gif?"+arr.join("&");$("caImg").src=url},a:function(from){if(!this.d){var d=document.domain.toLowerCase().split("."),dl=d.length,s="";if((dl>1)&&((s=d[dl-2])=="sohu")&&(dl>2)&&((s=d[dl-3])=="blog")&&(dl>3)&&(d[dl-4]=="v")){s="v"}this.d=s+"_"}this.q(this.d+from)}};if(typeof noClickAna=="undefined"||!noClickAna){Event.observe(window,"load",CA.init.bind(CA),false)};
